[
  {
    "name": "DuckDB Fuzzy CSV Header Mapping",
    "description": "Uses DuckDB's read_csv_auto to extract headers and fuzzy-matches them to a clean dictionary before loading. Solves Pandas trailing-comma issues.",
    "code": "import duckdb\ncon = duckdb.connect()\nheaders = [col[0] for col in con.execute(f\"SELECT * FROM read_csv_auto('{path}') LIMIT 0\").description]\n# Map headers...\nsel = ', '.join([f'\"{o}\" AS {c}' for o,c in mapped.items()])\ndf = con.execute(f\"SELECT {sel} FROM read_csv_auto('{path}')\").df()",
    "tags": ["duckdb", "cleaning", "csv", "fuzzy-match"]
  },
  {
    "name": "Chi-Squared Residual Heatmap",
    "description": "Calculates Chi-Squared standardized residuals for a crosstab and plots them as a heatmap to highlight severe statistical deviations.",
    "code": "from scipy.stats import chi2_contingency\nimport seaborn as sns\nimport numpy as np\ncrosstab = pd.crosstab(df[col1], df[col2])\nchi2, p, dof, exp = chi2_contingency(crosstab)\nresiduals = (crosstab - exp) / np.sqrt(exp)\nsns.heatmap(residuals, annot=True, cmap='RdBu_r', center=0)",
    "tags": ["stats", "chi-squared", "heatmap", "visualization", "anomaly"]
  }
]
